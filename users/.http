@baseUrl = http://localhost:8000/api/v1/auth
@contentType = application/json

### 1. Register a new user
POST {{baseUrl}}/register/
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "password": "password123",
  "password_confirm": "password123",
  "first_name": "John",
  "last_name": "Doe",
  "role": "student"
}

### 2. Register a teacher
POST {{baseUrl}}/register/
Content-Type: {{contentType}}

{
  "email": "teacher@example.com",
  "password": "password123",
  "password_confirm": "password123",
  "first_name": "Jane",
  "last_name": "Smith",
  "role": "teacher"
}

### 3. Login with email and password
# @name login
POST {{baseUrl}}/login/
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "password": "password123"
}

### 4. Save access token from login response
@accessToken = {{login.response.body.access}}
@refreshToken = {{login.response.body.refresh}}

### 5. Get user profile (requires authentication)
GET {{baseUrl}}/profile/
Authorization: Bearer {{accessToken}}
Content-Type: {{contentType}}

### 6. Request OTP for email verification
POST {{baseUrl}}/request-otp/
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "purpose": "email_verification"
}

### 7. Verify OTP for email verification
POST {{baseUrl}}/verify-otp/
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "otp": "123456",
  "purpose": "email_verification"
}

### 8. Verify email using token (simulated - you'll need actual token)
GET {{baseUrl}}/verify-email/550e8400-e29b-41d4-a716-446655440000/
Content-Type: {{contentType}}

### 9. Resend verification email
POST {{baseUrl}}/resend-verification/
Authorization: Bearer {{accessToken}}
Content-Type: {{contentType}}

### 10. Change password (requires authentication)
POST {{baseUrl}}/change-password/
Authorization: Bearer {{accessToken}}
Content-Type: {{contentType}}

{
  "old_password": "password123",
  "new_password": "newpassword123",
  "confirm_password": "newpassword123"
}

### 11. Request password reset OTP
POST {{baseUrl}}/request-password-reset/
Content-Type: {{contentType}}

{
  "email": "student@example.com"
}

### 12. Reset password using OTP
POST {{baseUrl}}/reset-password/
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "otp": "654321",
  "new_password": "newsecurepassword",
  "confirm_password": "newsecurepassword"
}

### 13. Request OTP for login (alternative login method)
POST {{baseUrl}}/request-otp/
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "purpose": "login"
}

### 14. Login using OTP
POST {{baseUrl}}/verify-otp/
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "otp": "789012",
  "purpose": "login"
}

### 15. Update user profile (requires authentication)
PUT {{baseUrl}}/profile/
Authorization: Bearer {{accessToken}}
Content-Type: {{contentType}}

{
  "first_name": "John Updated",
  "last_name": "Doe Updated",
  "bio": "I am a student learning new skills",
  "date_of_birth": "1995-05-15"
}

### 16. Refresh JWT token
POST {{baseUrl}}/token/refresh/
Content-Type: {{contentType}}

{
  "refresh": "{{refreshToken}}"
}

### 17. Verify JWT token
POST {{baseUrl}}/token/verify/
Content-Type: {{contentType}}

{
  "token": "{{accessToken}}"
}

### 18. Test invalid login (wrong password)
POST {{baseUrl}}/login/
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "password": "wrongpassword"
}

### 19. Test invalid registration (passwords don't match)
POST {{baseUrl}}/register/
Content-Type: {{contentType}}

{
  "email": "test@example.com",
  "password": "password123",
  "password_confirm": "differentpassword",
  "first_name": "Test",
  "last_name": "User",
  "role": "student"
}

### 20. Test invalid OTP verification
POST {{baseUrl}}/verify-otp/
Content-Type: {{contentType}}

{
  "email": "student@example.com",
  "otp": "wrongotp",
  "purpose": "email_verification"
}